<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Jadwal</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<!-- ðŸ” GUARD PALING ATAS -->
<script src="assets/js/guard.js"></script>

<!-- ðŸ§­ NAVBAR GLOBAL -->
<script src="assets/js/navbar.js"></script>

<div class="max-w-6xl mx-auto p-6 mt-6">
  <h1 class="text-xl font-semibold mb-6">Jadwal Kelas</h1>

  <div class="overflow-x-auto bg-white rounded-xl shadow">
    <table class="min-w-full table-fixed text-sm">
      
      <thead class="bg-gray-100">
  <tr>
    <th class="p-3 text-left w-1/5">Hari</th>
    <th class="p-3 text-center w-1/5">Jam</th>
    <th class="p-3 text-center w-1/5">Level</th>
    <th class="p-3 text-center w-1/5">Pengajar</th>
    <th class="p-3 text-center w-1/5" id="aksiHeader">Aksi</th>
  </tr>
</thead>
      <tbody id="jadwalBody" class="divide-y divide-gray-200">
        <!-- Data Firebase akan masuk di sini -->
      </tbody>

    </table>
  </div>
</div>


<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { 
  getFirestore, 
  collection, 
  getDocs,
  deleteDoc,
  doc
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDWe_8KQh5J5gzgKYDWnzNKiw-y1Vj3908",
  authDomain: "jp-nihongo-class.firebaseapp.com",
  projectId: "jp-nihongo-class",
  storageBucket: "jp-nihongo-class.firebasestorage.app",
  messagingSenderId: "102563702284",
  appId: "1:102563702284:web:9a5166a4f7450127647029"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const jadwalRef = collection(db, "Jadwal");

const role = localStorage.getItem("role");

// ================= LOAD DATA =================
async function loadJadwal() {
  const snapshot = await getDocs(jadwalRef);
  const tbody = document.getElementById("jadwalBody");
  tbody.innerHTML = "";

  snapshot.forEach((item) => {
    const data = item.data();
    const id = item.id;

    tbody.innerHTML += `
      <tr class="hover:bg-gray-50">
        <td class="p-3">${data.hari}</td>
        <td class="p-3 text-center">${data.jam}</td>
        <td class="p-3 text-center">${data.level}</td>
        <td class="p-3 text-center">${data.pengajar}</td>
        ${
          role === "admin"
          ? `<td class="p-3 text-center">
              <button onclick="hapusJadwal('${id}')" 
                class="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600">
                Hapus
              </button>
            </td>`
          : ""
        }
      </tr>
    `;
  });

  // sembunyikan header aksi kalau bukan admin
  if (role !== "admin") {
    const header = document.getElementById("aksiHeader");
    if (header) header.style.display = "none";
  }
}

window.hapusJadwal = async function(id) {
  if (confirm("Yakin ingin menghapus jadwal ini?")) {
    await deleteDoc(doc(db, "Jadwal", id));
    loadJadwal();
  }
};

loadJadwal();
</script>



<!-- ðŸ”‘ AUTH (LOGOUT) -->
<script src="assets/js/auth.js"></script>

</body>
</html>
